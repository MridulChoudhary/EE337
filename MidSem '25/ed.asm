ORG 0H          			 
LJMP MAIN       			

ORG 100H        			
MAIN:           			
CALL MAKE_PRIME
CALL ENCRYPT
HERE: SJMP HERE
ORG 130H

MAKE_PRIME: 
	MOV 70H, #03H
	MOV 71H, #04H
	MOV 75H, #04H
	MOV 74H, #03H
	
    MOV R3, 70H
	MOV R1, #01H
	MOV 79H, R3
	MOV R2, 79H
	DEC R2
	CALL IS_PRIME
	MOV 70H, R3
	
	MOV R3, 71H
	MOV R1, #01H
	MOV 79H, R3
	MOV R2, 79H
	DEC R2
	CALL IS_PRIME
	MOV 71H, R3
	RET
	
CHECK: 
	MOV B, R1
	MOV A, R3
	DIV AB 
	MOV R4, B
	CJNE R4, #00H, IS_PRIME
	CALL INCREASE
	RET
	
IS_PRIME:
	INC R1
	DEC R2
	CJNE R2, #00H, CHECK
	RET
	
INCREASE:
	INC R3
	MOV R1, #01H
	MOV 79H, R3
	MOV R2, 79H
	DEC R2
	CALL IS_PRIME
	RET

ENCRYPT:
	MOV A, 70H
	MOV B, 71H
	MUL AB
	MOV 73H, A
	MOV A, 70H
	MOV B, 71H
	DEC A
	DEC B
	MUL AB 
	MOV 72H, A
	
	MOV R4, 74H
	DEC R4
	MOV A, 75H
	CALL EXPONENT
	MOV B, 73H
	DIV AB 
	MOV 76H,B
	RET

EXPONENT:
	MOV B, 75H
	MUL AB 
	DEC R4
	CJNE R4, #00H, EXPONENT
	RET
	
DECRYPTION:
	

END